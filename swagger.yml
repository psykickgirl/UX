swagger: "2.0"
host: staging.waas.drinks.com
basePath: /v2
info:
  version: "2.0"
  title: Wine-As-A-Service API
  x-logo:
    url: https://s3-us-west-2.amazonaws.com/partners.drinks.com/docs/logo.png
    backgroudColor: "#263238"
schemes:
  - "https"
paths:
  /compliance/tax:
    post:
      tags:
        - Compliance
      summary: calculate tax
      description: Retrieve tax related information such as the tax amount due and any checkout disclaimers
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - in: body
          name: body
          description: Input data for tax calculation
          required: true
          schema:
            $ref: "#/definitions/TaxPostRequest"
      responses:
        200:
          description: Tax calculated successfully
          schema:
            $ref: "#/definitions/TaxPostResponse"
        400:
          description: Bad request
          schema:
            $ref: "#/definitions/Error"
        401:
          description: Unauthorized
          schema:
            $ref: "#/definitions/UnauthorizedResponse"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/InternalServerError"
      security:
        - api_key: []
  /inventory:
    get:
      tags:
        - Inventory
      summary: get inventory
      description: Retrieve inventory related information such as warehouse mapping,
                   available inventory in each warehouse, and product catalog detail
      parameters:
        - in: query
          name: show_details
          type: boolean
          required: false
          allowEmptyValue: true
          description: adds product catalog detail data to the response
      produces:
        - application/json
      responses:
        200:
          description: Ok
          schema:
            $ref: "#/definitions/InventoryGetResponse"
        401:
          description: Unauthorized
          schema:
            $ref: "#/definitions/UnauthorizedResponse"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/InternalServerError"
      security:
        - api_key: []
  /orders:
    get:
      tags:
        - Orders
      summary: get order status
      description: Retrieve order related information such as order status, tracking number, and shipped date
      produces:
        - application/json
      parameters:
        - in: query
          name: order_ids
          description: list of order_ids (commma separated)
          required: true
          type: string
      responses:
        200:
          description: Successful operation
          schema:
            $ref: "#/definitions/OrderGetResponse"
        400:
          description: Bad request
          schema:
            $ref: "#/definitions/Error"
        401:
          description: Unauthorized
          schema:
            $ref: "#/definitions/UnauthorizedResponse"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/InternalServerError"
      security:
        - api_key: []
    post:
      tags:
        - Orders
      summary: submit order
      description: Submit a new order for fulfillment
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - in: body
          name: body
          description: Input data for order submission
          required: true
          schema:
            $ref: "#/definitions/OrderPostRequest"
      responses:
        202:
          description: Accepted
          schema:
            $ref: "#/definitions/OrderPostResponse"
        400:
          description: Bad request
          schema:
            $ref: "#/definitions/Error"
        401:
          description: Unauthorized
          schema:
            $ref: "#/definitions/UnauthorizedResponse"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/InternalServerError"
      security:
        - api_key: []
    put:
      tags:
        - Orders
      summary: update order
      description: <b>\*For testing purposes only!\*</b> Update an order status directly
      produces:
        - application/json
      parameters:
        - name: body
          in: body
          description: Input data for update order
          required: true
          schema:
            $ref: "#/definitions/OrderPutRequest"
      responses:
        202:
          description: updates accepted
          schema:
            $ref: "#/definitions/OrderPutResponse"
        401:
          description: Unauthorized
          schema:
            $ref: "#/definitions/UnauthorizedResponse"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/InternalServerError"
      security:
        - api_key: []
    delete:
      tags:
        - Orders
      summary: cancel order
      description: Delete order if possible, and stop it from being fulfilled
      produces:
        - application/json
      parameters:
        - name: body
          in: body
          description: order_id to cancel
          required: true
          schema:
            $ref: "#/definitions/OrderDeleteRequest"
      responses:
        202:
          description: Accepted
          schema:
            $ref: "#/definitions/OrderDeleteResponse"
        422:
          description: Unprocessable Entity
          schema:
            $ref: "#/definitions/OrderDeleteUnprocessable"
        401:
          description: Unauthorized
          schema:
            $ref: "#/definitions/UnauthorizedResponse"
        500:
          description: Internal Server Error
          schema:
            $ref: "#/definitions/InternalServerError"
      security:
        - api_key: []
securityDefinitions:
  api_key:
    type: "apiKey"
    name: "Authorization"
    in: "header"
    description: Authentication is handled by submitting an api key when required
definitions:
  TraceId:
    type: string
    description: id used to reference the request
    example: a429690f-e85a-4c32-544f
  CheckoutDisclaimerItems:
    type: object
    properties:
      message:
        type: string
        description: "disclaimer message to be displayed on checkout"
        example: I confirm that I am at least 21 years old
      actions:
        type: array
        items:
          type: string
          enum:
            - customer_confirmation_required
          example: "customer_confirmation_required"
  LineItems:
    type: object
    properties:
      sku:
        type: string
        example: "N01004"
      quantity:
        type: number
        example: 12
    required:
      - sku
      - quantity
  Warehouse:
    type: object
    properties:
      warehouse:
        type: string
        example: "COB"
      available:
        type: integer
        format: int64
        example: 256
  Images:
    type: object
    properties:
      thumbnail:
        type: string
        example: thumbnail-image.png
      small:
        type: string
        example: small-image.png
      medium:
        type: string
        example: medium-image.png
      large:
        type: string
        example: large-image.png
      xlarge:
        type: string
        example: xlarge-image.png
      full:
        type: string
        example: full-image.png
  AdditionalImages:
    type: object
    properties:
      thumbnail:
        type: string
        example: thumbnail-side-image.png
      small:
        type: string
        example: small-side-image.png
      medium:
        type: string
        example: medium-side-image.png
      large:
        type: string
        example: large-side-image.png
      xlarge:
        type: string
        example: xlarge-side-image.png
      full:
        type: string
        example: full-side-image.png
      tags:
        type: array
        items:
          type: string
        example:
          - side-img
          - main
  Error:
    type: object
    properties:
      trace_id:
        $ref: "#/definitions/TraceId"
      errors:
        type: array
        items:
          type: object
          properties:
            message:
              type: string
              enum:
                - "missing required params: [param]"
                - "invalid params: [param]"
  UnauthorizedResponse:
    type: object
    properties:
      trace_id:
        $ref: "#/definitions/TraceId"
      errors:
        type: array
        items:
          type: object
          properties:
            message:
              type: string
              example: Unauthorized
  InternalServerError:
    type: object
    properties:
      trace_id:
        $ref: "#/definitions/TraceId"
      errors:
        type: array
        items:
          type: object
          properties:
            message:
              type: string
              example: Something went wrong. Please contact DRINKS with the trace_id
  CustomerRequest:
    type: object
    properties:
      customer_id:
        type: string
        example: "CUST-123"
      first_name:
        type: string
        example: "Marina"
      last_name:
        type: string
        example: "Colors"
      dob:
        type: string
        format: date
        example: "1988-01-18"
      phone:
        type: string
        example: "310-315-0000"
    required:
      - first_name
      - last_name
      - dob
  ShippingAddressRequest:
    type: object
    properties:
      first_name:
        type: string
        example: "Marina"
      last_name:
        type: string
        example: "Colors"
      phone:
        type: string
        example: "310-315-0000"
      dob:
        type: string
        format: date
        example: "1988-01-18"
      street1:
        type: string
        example: "345 N. Maple Dr"
      street2:
        type: string
        example: "Suite. 315"
      city:
        type: string
        example: "Beverly Hills"
      state:
        type: string
        example: "CA"
      zip:
        type: string
        example: "90210"
    required:
      - first_name
      - last_name
      - dob
      - street1
      - city
      - state
      - zip
  ShippingAddressTaxRequest:
    type: object
    properties:
      street1:
        type: string
        example: "345 N. Maple Dr"
      street2:
        type: string
        example: "Suite. 315"
      city:
        type: string
        example: "Beverly Hills"
      state:
        type: string
        example: "CA"
      zip:
        type: string
        example: "90210"
    required:
      - street1
      - city
      - state
      - zip
  ShippingAddress:
    type: object
    properties:
      street1:
        type: string
        example: "345 N. Maple Dr"
      street2:
        type: string
        example: "Suite. 315"
      city:
        type: string
        example: "Beverly Hills"
      state:
        type: string
        example: "CA"
      zip:
        type: string
        example: "90210"
  CheckoutDisclaimers:
    type: array
    description: disclaimers that may require action
    items:
      $ref: "#/definitions/CheckoutDisclaimerItems"
  TaxPostRequest:
    type: object
    properties:
      shipping_address:
        $ref: "#/definitions/ShippingAddressTaxRequest"
      subtotal:
        type: number
        format: float
        example: 149.95
      shipping:
        type: number
        format: float
        example: 9.95
      line_items:
        type: array
        items:
          $ref: "#/definitions/LineItems"
    required:
      - shipping_address
      - subtotal
      - shipping
      - line_items
  TaxPostResponse:
    type: object
    properties:
      trace_id:
        $ref: "#/definitions/TraceId"
      transfer_of_title_used:
        type: boolean
        description: internal use only
        example: false
      total_tax:
        type: number
        format: float
        description: the tax that should be charged on the order
        example: 12.25
      taxes:
        type: object
        description: a list of taxes used to create the total_tax
        properties:
          tax:
            type: number
            format: float
            example: 12.25
      shipping_address:
        $ref: "#/definitions/ShippingAddress"
      subtotal:
        type: number
        format: float
        example: 149.95
      shipping:
        type: number
        format: float
        example: 9.95
      checkout_disclaimers:
        $ref: "#/definitions/CheckoutDisclaimers"
  InventoryGetResponse:
    type: object
    properties:
      trace_id:
        $ref: "#/definitions/TraceId"
      warehouses:
        type: object
        properties:
          COB:
            type: object
            properties:
              states:
                type: array
                example: ["NJ", "NY", "PA"]
                items:
                  type: string
          VCA:
            type: object
            properties:
              states:
                type: array
                example: ["AZ", "CA", "CO"]
                items:
                  type: string
      items:
        type: object
        properties:
          N01004:
            type: object
            properties:
              warehouses:
                type: array
                items:
                  $ref: "#/definitions/Warehouse"
              details:
                type: object
                properties:
                  name:
                    type: string
                    example: "2017 Hayton Family Reserve White Blend"
                  description:
                    type: string
                    example: "This special recipe California white was created with two adjectives in mind: fruity and vibrant. Pour a glass and enjoy a floral nose, and a palate that refreshes with apricot and citrus. Serve this smooth favorite with a crisp salad and lemon-baked fish."
                  is_alcoholic:
                    type: boolean
                    example: true
                  images:
                    type: object
                    $ref: "#/definitions/Images"
                  additional_images:
                    type: array
                    items:
                      $ref: "#/definitions/AdditionalImages"
                  price:
                    type: string
                    example: "99.95"
                  bottle_count:
                    type: integer
                    example: 6
                  volume:
                    type: object
                    properties:
                      amount:
                        type: string
                        example: "4500"
                      unit:
                        type: string
                        enum:
                          - ml
                  upc:
                    type: string
                    example: 9099090909090
                  pack_details:
                    type: object
                    properties:
                      products:
                        type: array
                        items:
                          type: object
                          properties:
                            sku:
                              type: string
                              example: N01121
                            quantity:
                              type: integer
                              example: 6
  OrderGetResponse:
    type: object
    properties:
      trace_id:
        $ref: "#/definitions/TraceId"
      orders:
        type: array
        items:
          type: object
          properties:
            order_id:
              type: string
            drinks_order_id:
              type: string
            placed:
              type: integer
            status:
              type: string
              enum:
                - UNKNOWN_ORDER_ID
                - PROCESSING
                - SHIPPED
                - DELIVERED
                - CANCELLED
                - BACKORDERED
            parcels:
              type: array
              items:
                type: object
                properties:
                  tracking_number:
                    type: string
                  shipped_date:
                    type: string
                    format: integer
                  delivered_date:
                    type: string
                    format: integer
                  carrier:
                    type: string
                    enum:
                      - FedEx
                      - UPS
            backordered_items:
              type: array
              items:
                type: object
                properties:
                  sku:
                    type: string
        example:
          - order_id: WAAS-1234
            drinks_order_id: 6543210
            placed: 1525902483
            status: SHIPPED
            parcels:
              - tracking_number: 780000130761
                shipped_date: 1525902483
                delivered_date: null
                carrier: FedEx
            backordered_items: []
          - order_id: WAAS-2345
            drinks_order_id: 6543211
            placed: 1525902485
            status: DELIVERED
            parcels:
              - tracking_number: 780000130762
                shipped_date: 1525902483
                delivered_date: 1525902485
                carrier: FedEx
            backordered_items: []
          - order_id: WAAS-3456
            drinks_order_id: 6543212
            placed: 1525902485
            status: BACKORDERED
            parcels: []
            backordered_items:
              - sku: N01004
          - order_id: FAKE-123
            drinks_order_id: null
            status: UNKNOWN_ORDER_ID
            parcels: []
  OrderPostRequest:
    type: object
    properties:
      order_id:
        type: string
        example: "WAAS-54321"
      original_order_id:
        type: string
        description: Provided when order reship is requested
        example: null
      customer:
        $ref: "#/definitions/CustomerRequest"
      shipping_address:
        $ref: "#/definitions/ShippingAddressRequest"
      subtotal:
        type: number
        format: float
        example: 149.95
      shipping:
        type: number
        format: float
        example: 9.95
      tax:
        type: number
        format: float
        example: 12.25
      discount:
        type: number
        format: float
      include_welcome_letter:
        type: boolean
        example: true
      include_top_mat:
        type: boolean
        example: true
      line_items:
        type: array
        items:
          $ref: "#/definitions/LineItems"
      warehouse:
        type: string
        enum:
          - COB
          - STL
          - VCA
    required:
      - order_id
      - customer
      - shipping_address
      - subtotal
      - shipping
      - tax
      - line_items
  OrderPostResponse:
    type: object
    properties:
      trace_id:
        $ref: "#/definitions/TraceId"
      order_id:
        type: string
        example: "WAAS-54321"
      drinks_order_id:
        type: string
        example: "6543210"
      original_order_id:
        type: string
        description: Only visible when the request contains original_order_id
        example: null
  OrderPutRequest:
    type: object
    properties:
      order_id:
        type: string
        example: WAAS-2345
      mock:
        type: object
        properties:
          status:
            type: string
            enum:
              - BACKORDERED
              - SHIPPED
              - DELIVERED
              - CANCELLED
          line_items:
            type: array
            items:
              type: object
              properties:
                sku:
                  type: string
                  example: "N01004"
                backordered:
                  type: boolean
                  example: true
        required:
          - status
    required:
      - order_id
      - mock
  OrderPutResponse:
    type: object
    properties:
      trace_id:
        $ref: "#/definitions/TraceId"
      accepted:
        type: boolean
  OrderDeleteRequest:
    type: object
    properties:
      order_id:
        type: string
        example: "WAAS-54321"
    required:
      - order_id
  OrderDeleteResponse:
    type: object
    properties:
      trace_id:
        $ref: "#/definitions/TraceId"
      accepted:
        type: boolean
  OrderDeleteUnprocessable:
    type: object
    properties:
      message:
        type: string
        example: "unable to cancel"
